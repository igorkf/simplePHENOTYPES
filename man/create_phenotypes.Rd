% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_phenotypes.R
\name{create_phenotypes}
\alias{create_phenotypes}
\title{Simulation of ntraits phenotypes based on a SNP file}
\usage{
create_phenotypes(genotypes_object = NULL, genotypes_file = NULL,
  genotypes_path = NULL, input_format = "hapmap", nrows = Inf,
  na_string = "NA", shared_name = NULL, maf_cutoff = NULL,
  SNP_effect = "Add", SNP_impute = "Middle",
  major_allele_zero = FALSE, additive_QTN_number = NULL,
  epistatic_QTN_number = NULL, additive_effect = NULL,
  epistatic_effect = NULL, big_additive_QTN_effect = NULL,
  model = "pleiotropic", overlap = NULL, overlap_e = NULL,
  specific_QTN_number = NULL, specific_e_QTN_number = NULL, ld = 0.5,
  rep = NULL, rep_by = "QTN", ntraits = 1, h2 = NULL,
  h2_MT = NULL, correlation = NULL, seed = NULL,
  home_dir = getwd(), output_dir = NULL, to_r = FALSE,
  output_format = "multi-file", out_geno = NULL, gdsfile = NULL,
  constrains = list(maf_above = NULL, maf_below = NULL))
}
\arguments{
\item{genotypes_object}{Marker data set loaded as an R object 
(currently accepting either HapMap or numericalized files). 
Only one of `genotypes_object`, `genotypes_file` or `genotypes_path` should be used.}

\item{genotypes_file}{Name of a marker data set to be read from file.}

\item{genotypes_path}{Path to a folder with multiple marker data set files 
(e.g. separated by chromosome).}

\item{input_format}{Currently only "hapmap" is implemented.}

\item{nrows}{Please see data.table::fread for details.}

\item{na_string}{Sets missing data as "NA".}

\item{shared_name}{If files are saved by chromosome and in a folder with 
other files, a portion of the name may be used to match files 
(e.g. shared_name = "Chr" for files Chr1.hmp.txt, ..., Chr10.hmp.txt).}

\item{maf_cutoff}{Optional filter for minor allele frequency 
(The dataset will be filtered. Not to be confunded with the constrain option
which will only filter possible QTNs).}

\item{SNP_effect}{Following GAPIT implementation. Default 'Add'.}

\item{SNP_impute}{Following GAPIT implementation. Default 'Middle'.}

\item{major_allele_zero}{Following GAPIT implementation. Default FALSE.}

\item{additive_QTN_number}{Number of additive quantitative trait nucleotide
to be simulated.}

\item{epistatic_QTN_number}{Number of epistatic (additive x additive)
quantitative trait nucleotide to be simulated.}

\item{additive_effect}{Additive effect size to be simulated. Follows a
geometric series.}

\item{epistatic_effect}{Epistatic (additive x additive) effect size to be
simulated. Follows a geometric series.}

\item{big_additive_QTN_effect}{Additive effect size for one possible major
effect quantitative trait nucleotide.}

\item{model}{Genetic architecture to be simulated. Possible options are:
'pleiotropic', for traits being controled by all the same QTNs;
'partially', for traits being controled by pleiotropic and trait specific QTNs;
'LD', for traits being exclusively controled QTNs in linkage disequilibrium.}

\item{overlap}{Number of pleiotropic additive QTNs if model = 'partially'.}

\item{overlap_e}{Number of pleiotropic epistatic QTNs if model = 'partially'.}

\item{specific_QTN_number}{Number of trait specific additive QTNs if
model = 'partially'.}

\item{specific_e_QTN_number}{Number of trait specific epistatic QTNs if
model = 'partially'.}

\item{ld}{Linkage disequilibrium between selected marker two adjacent markers
to be used as QTN. Default is ld = 05.}

\item{rep}{Number of experiments to be simulated.}

\item{rep_by}{Simulate same QTNs but with different residuals ('residuals'). 
Simulate each replication with different QTNs (Defalut 'QTN').}

\item{ntraits}{Number of traits to be simulated under pleitropic and
partially pleiotropic models. The default for linkage disequilibrium models is two.}

\item{h2}{Heritability of target trait (if multiple traits are simulated).
If a vector, the simulation will "loop" over it and generate one file for each
combination of genetic settings.}

\item{h2_MT}{Heritability of correlated traits (in case it should be different).
than target trait. It should be length ntraits-1.}

\item{correlation}{Trait correlation matrix to be simulated. 
Should have nrow == ncol == ntraits.}

\item{seed}{Value to be used by set.seed. If NULL (default),
runif(1, 0, 10e5) will be used.}

\item{home_dir}{Home directory. Default is current working directory.}

\item{output_dir}{Name to be used to create folder and save output files.}

\item{to_r}{Option for saving simulated results to R in addition to saving to file. 
If TRUE, results need to be assinged to an R object (see vign).}

\item{output_format}{Four options for saving outputs: 'multi-file'
(default for multiple traits), saves one simulation setting in a separate file;
'long', appends each experiment (rep) to the last one (by row); 'wide', saves
experiments by column (default for single trait) and 'gemma', saves .fam files 
to be used by gemma with plink bed files (renaming .fam file might be necessary).}

\item{out_geno}{Saves numericalized genotype either as "numeric", "plink" or "gds".
Default is NULL.}

\item{gdsfile}{gds file (in case there is one already created) to be used
with option model = "LD". Default is NULL.}

\item{constrains}{Set constrains for QTN selection. 
Currently only minor allelic frequency is implemented. 
Eiter one or both of the following options may be non-null: 'list(maf_above = NULL, maf_below = NULL)'.}
}
\value{
Numericalized marker dataset, selected QTNs, phenotypes for 'ntraits' traits.
}
\description{
Simulation of ntraits phenotypes based on a SNP file
}
\examples{
# Simulate 50 replications of a single phenotype.

pheno <- create_phenotypes(
  genotypes_object = SNP55K_maize282_maf04,
  additive_QTN_number = 3,
  additive_effect = c(0.1, 0.2),
  big_additive_QTN_effect = 0.9,
  rep = 50,
  h2 = 0.7,
  to_r = TRUE
)

}
\author{
Samuel Fernandes and Alexander Lipka
Last update: Aug 2nd, 2019
}
